---
title: "Portfolio for Computational Musicology: Analyzing The Weeknd"
author: "Xinyu Zhu"
date: "February 2024"
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
    self_contained: false
    theme:
      heading_font:
        google: 
          family: Rajdhani
          wght: 700
      base_font:
        google: Fira Sans
      code_font:
        google: Fira Mono
      bg: "#FFFFFF"
      fg: "#212529" 
      primary: "#2f768d"
      secondary: "#39d7b8"
      success: "#39d7b8"
      danger: "#fa5577"
      warning: "#ffb14c"
      info: "#0cc7f1"
---

```{r setup, include=FALSE}
library(flexdashboard)

readRenviron(".Renviron")
```

### Corpus description

The portfolio focuses on a corpus that consists of songs made by The Weeknd as well as songs featured by The Weeknd. I decided to analyse this specific kind of corpus, because The Weeknd was the most listened artist from my sportify wrapped and I was interested in the factors that made me drawn to his music. To make the analyses more concrete, I decided to compare different points from the corpus, namely the songs from The Weeknd and the songs that he was featured in. Specifically, I will first examine the songs from The Weeknd to gain a greater insight from his music and then I will evaluate to what extend the music changes when he is featured in songs of other artists. This way I hope to discover what characteristics in his music make him distinctive as an artist, even in the featured songs. As a matter of fact, I expect that the dynamics of the compared songs would be different in general, but the featured parts of the Weeknd would be quite similar to the Weeknd’s own songs. The one thing that I would be unsure about, however, is to which degree these featured parts are similar to the Weeknd’s own songs. All in all, I think the tracks from my corpus are quite representative for the groups that I want to compare, since it is predominantly focused on one artist. However, I will not cover all songs produced by The Weeknd, so I must note that the analyses could differ substantially per song and comparison.

To provide a better overview of my corpus, I have listed some examples of typical songs below. These songs I would consider typical, because they are one of the many songs that represent The Weeknd catalogue.

Non-featured songs:

  - Missed You - Bonus Track by The Weeknd
  - Wicked Games by The Weeknd

Featured songs:

  - Or Nah by Ty Dolla $ign, The Weeknd, Wiz Khalifa and Mustard
  - Creepin’ by Metro Boomin, The Weeknd and 21 Savage
  
```{r}
library(tidyverse)
library(spotifyr)
library(knitr)
library(ggplot2)
library(ggjoy)
library(plotly)
```


### In your feelings

```{r, fig.width=10}
weeknd_tracks <- get_track_audio_features(c("5SGEPm9ge10bD4j3ec9UHV"))
weeknd_albumtracks <- get_album_tracks("742eAldb4AJKLoPgJhGRE7")
weeknd <- get_artist_audio_features('the weeknd')
corpus <- get_playlist_audio_features("", "4XcUvhRB3cwMXyN7Jy1C2H")
corpus_feat <- get_playlist_audio_features("", "4TEjBviN4UjutCCpFKnUoD")

valence_songs <- get_artist_audio_features('the weeknd')

ggplot(valence_songs, aes(x = valence, y = album_name)) + 
    geom_joy(scale = 0.9, fill="lightblue") + 
    theme_joy() +
    ggtitle("Valence distributions of the Weeknds's songs") + 
    labs(x="Valence", y = "Album name")

```

***

To gain more insight into the Weeknd's music, I have first analyzed the underlying audio features of his songs alone. When looking at the Valence image, you can see that all of his albums has a quite low valence score (mostly below 0.5), which means that it is more likely to be associated with negative feelings.

### Let's dance?
```{r, fig.width=10}
danceability_songs1 <- get_artist_audio_features('the weeknd')
ggplot(danceability_songs1, aes(x = danceability, y = album_name)) + 
    geom_joy(scale = 0.9, fill="lightblue") + 
    theme_joy() +
    ggtitle("Danceability distributions of the Weeknds's songs") +
    labs(x="Danceability", y = "Album name")
```

***
On the other hand, the Danceability score of his albums are more on the higher side (mostly above 0.5), which means that his songs are more danceable in general.

### How does emotional valence affect The Weeknd's songs?  
```{r}
audio_feat1 <- get_artist_audio_features('the weeknd')
data <- audio_feat1 |> ggplot(aes(x = valence, y = danceability, color=energy, label = track_name )) + geom_point()  +
         ggtitle("Analysis of the Weeknd's songs based on audio features") +
         xlab("Valence") +
         ylab("Danceability") +
         labs(colour = "Energy") + geom_smooth()
interactive <- ggplotly(data)
interactive
```

***
That there was a difference in these feature scores was actually quite surprising, especially since one would expect a positive correlation between these features instead of a negative one, as can be seen in the scatterplot image. Not only that, but they both also positively correlate with the energy scores, which seems reasonable given their interplay with eachother. The interesting part would therefore be about the difference between the scatter plot correlations and the feature distributions. It would be fascinating to examine why the danceability scores were quite high, despite the low overall valence scores, and how it was affected by other audio features. 

### Chroma features
listen to diff kinds of music
besides listening to rb and hiphop, i like to listen to spanish music, namely reggaeton and urbano latino
2 spanish songs where weeknd was featured 

### Concluding remarks
Still to be edited in the future
```{r}

```
